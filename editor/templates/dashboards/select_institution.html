{% extends "base_dashboard.html" %}
{# 
    LIMPIEZA ARQUITECTÓNICA
    
    Solo muestra opciones para Tutor y Estudiante.
    ❌ Admin usa Django Admin
    ❌ Institution es solo información
#}

{% block title %}Seleccionar Institución - MAX-IDE{% endblock %}

{% block content %}
<div class="page-header" style="text-align: center; max-width: 600px; margin: 0 auto 2rem;">
    <h1 class="page-title">
        <i class="fas fa-building" style="color: var(--color-purple);"></i>
        Selecciona tu Institución
    </h1>
    <p class="page-subtitle">Tienes acceso a múltiples instituciones. Selecciona una para continuar.</p>
</div>

<div style="max-width: 600px; margin: 0 auto;">
    {% for membership in memberships %}
    {# Solo mostrar membresías de tutor o student #}
    {% if membership.role == 'tutor' or membership.role == 'student' %}
    <a href="{% if membership.role == 'tutor' %}{% url 'tutor_dashboard' slug=membership.institution.slug %}{% else %}{% url 'student_dashboard' slug=membership.institution.slug %}{% endif %}" class="card animate-in" style="display: block; text-decoration: none; color: inherit; margin-bottom: 1rem; transition: all var(--transition-fast);">
        <div class="card-body" style="display: flex; align-items: center; gap: 1rem;">
            <div style="width: 56px; height: 56px; background: linear-gradient(135deg, var(--color-purple), var(--color-primary)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; font-weight: 700;">
                {{ membership.institution.name|slice:":1"|upper }}
            </div>
            <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 1.1rem; margin-bottom: 0.25rem;">
                    {{ membership.institution.name }}
                </div>
                <div style="color: var(--color-text-muted); font-size: 0.85rem;">
                    {{ membership.institution.code }}
                </div>
            </div>
            <div>
                <span class="status-badge active" style="background: {% if membership.role == 'tutor' %}var(--color-warning-glow); color: var(--color-warning);{% else %}var(--color-success-glow); color: var(--color-success);{% endif %}">
                    <i class="fas {% if membership.role == 'tutor' %}fa-chalkboard-teacher{% else %}fa-user-graduate{% endif %}"></i>
                    {% if membership.role == 'tutor' %}Tutor{% else %}Estudiante{% endif %}
                </span>
            </div>
            <div style="color: var(--color-text-muted);">
                <i class="fas fa-chevron-right"></i>
            </div>
        </div>
    </a>
    {% endif %}
    {% empty %}
    <div class="empty-state">
        <i class="fas fa-building"></i>
        <p>No tienes acceso a ninguna institución</p>
        <p style="font-size: 0.85rem;">Contacta al administrador del sistema</p>
    </div>
    {% endfor %}
</div>

<div class="card" style="max-width: 600px; margin: 2rem auto 0; background: var(--color-bg-hover);">
    <div class="card-body" style="text-align: center;">
        <p style="color: var(--color-text-muted); margin: 0; font-size: 0.9rem;">
            <i class="fas fa-info-circle"></i>
            Si eres administrador, usa el 
            <a href="/admin/" style="color: var(--color-primary);">Panel de Django Admin</a>
        </p>
    </div>
</div>

<style>
    .card:hover {
        border-color: var(--color-primary);
        box-shadow: var(--shadow-glow);
        transform: translateY(-2px);
    }
</style>
{% endblock %}
